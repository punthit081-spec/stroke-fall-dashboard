<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Stroke Unit Fall Monitor</title>

<style>
body {
    margin:0;
    background:black;
    font-family:Arial, sans-serif;
    color:white;
}

h1 {
    text-align:center;
    padding:20px;
    font-size:40px;
}

.header, .row {
    display:grid;
    grid-template-columns: 2fr 1fr 1fr 1fr 1fr;
    padding:15px;
    align-items:center;
}

.header {
    background:#222;
    font-size:22px;
    font-weight:bold;
}

.row {
    border-bottom:1px solid #333;
    font-size:20px;
}

.row:nth-child(even){
    background:#111;
}

.low { color:lime; }
.moderate { color:orange; }
.high { color:red; }

.dot {
    font-size:22px;
}

.checkbox {
    transform: scale(1.4);
    cursor:pointer;
}
</style>
</head>

<body>

<h1>Stroke Unit Fall Monitor</h1>

<div class="header">
    <div>‡∏ä‡∏∑‡πà‡∏≠</div>
    <div>‡πÄ‡∏ï‡∏µ‡∏¢‡∏á</div>
    <div>Fall Score</div>
    <div>Risk</div>
    <div>‡∏™‡∏±‡∏ö‡∏™‡∏ô</div>
</div>

<div id="data"></div>

<script>

const sheetURL = "https://script.google.com/macros/s/AKfycbw-FcxVRFNVLhdWchNqlhJM-LfsNFSbcUBD6UwwOC6RCOEddb6BdRXPj6Pbf-083iap/exec";

/* üî• ‡πÉ‡∏™‡πà URL Apps Script ‡∏Ç‡∏≠‡∏á‡πÄ‡∏ò‡∏≠‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà */
const API_URL = "PUT_YOUR_APPS_SCRIPT_URL_HERE";

function loadData(){
    fetch(sheetURL)
    .then(res => res.json())
    .then(data => {

        const table = document.getElementById("data");
        table.innerHTML = "";

        data.forEach(row => {

            if(!row.Name) return;

            let riskClass = "low";
            if(row.Risk === "Moderate") riskClass = "moderate";
            if(row.Risk === "High") riskClass = "high";

            table.innerHTML += `
                <div class="row">
                    <div>${row.Name}</div>
                    <div>${row.Bed}</div>
                    <div>${row.FallTotal}</div>
                    <div class="${riskClass}">
                        <span class="dot">‚óè</span> ${row.Risk}
                    </div>
                    <div>
                        <input type="checkbox" 
                               class="checkbox"
                               onchange="updateConfused('${row.Bed}', this)">
                    </div>
                </div>
            `;
        });

    });
}

function updateConfused(bed, checkbox){

    fetch(API_URL, {
        method: "POST",
        body: JSON.stringify({
            bed: bed,
            confused: checkbox.checked
        })
    })
    .then(res => res.text())
    .then(result => {
        console.log("Updated:", result);
    })
    .catch(err => {
        console.error("Error:", err);
    });
}

loadData();
setInterval(loadData, 5000);

</script>

</body>
</html>
