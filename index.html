<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Stroke Unit Fall Monitor</title>

<style>
body {
    margin:0;
    background:black;
    font-family:Arial, sans-serif;
    color:white;
}

h1 {
    text-align:center;
    padding:20px;
    font-size:40px;
    margin:0;
}

.title-bar {
    position:relative;
}

.current-count {
    position:absolute;
    top:24px;
    right:28px;
    font-size:22px;
    background:#1f1f1f;
    border:1px solid #3a3a3a;
    border-radius:8px;
    padding:10px 14px;
    color:#6fd3ff;
}

.header, .row {
    display:grid;
    grid-template-columns: 2fr 1fr 1fr 1fr;
    padding:15px;
    align-items:center;
}

.header {
    background:#222;
    font-size:22px;
    font-weight:bold;
}

.row {
    border-bottom:1px solid #333;
    font-size:20px;
}

.row:nth-child(even){
    background:#111;
}

.low { color:lime; }
.moderate { color:orange; }
.high { color:red; }

.dot {
    font-size:22px;
}
</style>
</head>

<body>

<div class="title-bar">
    <h1>Stroke Unit Fall Monitor</h1>
    <div id="currentCount" class="current-count">จำนวนคนปัจจุบัน: 0</div>
</div>

<div class="header">
    <div>ชื่อ</div>
    <div>เตียง</div>
    <div>Fall Score</div>
    <div>Risk</div>
</div>

<div id="data"></div>

<script>
const sheetURL = "https://opensheet.elk.sh/1dc_L7he2jDu64q8OBGbCEnf2gcrJ16nn7-NiwvbOXW4/dashboard";

function loadData(){
    fetch(sheetURL)
    .then(res => res.json())
    .then(data => {

        const table = document.getElementById("data");
        const countDisplay = document.getElementById("currentCount");
        table.innerHTML = "";
        let currentCount = 0;

        data.forEach(row => {

            if(!row.Name) return;
            currentCount += 1;

            let riskClass = "low";
            if(row.Risk === "Moderate") riskClass = "moderate";
            if(row.Risk === "High") riskClass = "high";

            table.innerHTML += `
                <div class="row">
                    <div>${row.Name}</div>
                    <div>${row.Bed}</div>
                    <div>${row.FallTotal}</div>
                    <div class="${riskClass}">
                        <span class="dot">●</span> ${row.Risk}
                    </div>
                </div>
            `;
        });

        countDisplay.textContent = `จำนวนคนปัจจุบัน: ${currentCount}`;

    });
}

loadData();
setInterval(loadData, 5000); // refresh ทุก 5 วิ
</script>

</body>
</html>

